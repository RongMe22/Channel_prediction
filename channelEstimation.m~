function [theta] = channelEstimation(csi_sample)
% theta is a L*3 vector: [alpha, phi, tau] 
% [alpha, -, -]_l: the amplitude of the path l;
% [-, phi, -]_l: the azimuth angle of the path l;
% [-, -, tau]_l: the delay of the path l;

globals_init();


parameter = cell(iteration+1);

theta = parameter_initialization(L);
parameter{1} = theta;


% Iterating 1000 times;
for a = 1:iteration
    
    % Expectation step (E-step)
    X = eStep(parameter{a},freq, L, M, csi_sample, lambda,d);
    
    % Maximization step (M-step)
    theta_next = mStep (X, freq, L, M, lambda,d);
    parameter{a+1} = theta_next;
end



end

function globals_init
    %% physical
    % labmda: wavelength of the signal;
    % freq: frequency of the signal;
    % M: antenna array size;
    % L is the number of propagation paths;
    % d is spacing between adjacent antennas of the receiver antenna array;
    global FREQUENCY SPEED_OF_LIGHT LAMBDA M L 
    FREQUENCY = 5.2e9;  %unit hz
    SPEED_OF_LIGHT = 3e8;  %unit m/s
    LAMBDA = SPEED_OF_LIGHT/FREQUENCY;
    M = 3;
    L = 8;
    d = 12;


iteration = 999;

end